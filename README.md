# LeafAuto_Win7 项目开发文档

**最后更新：2025年3月3日**

---

## 目录

1. [概述](#概述)
2. [目录结构](#目录结构)
3. [技术栈](#技术栈)
4. [功能模块概览](#功能模块概览)
5. [关键特性](#关键特性)
6. [运行原理](#运行原理)
7. [依赖库列表](#依赖库列表)
8. [安装与配置](#安装与配置)
9. [常见问题](#常见问题)
10. [贡献指南](#贡献指南)
11. [许可证](#许可证)

---

## 概述

**LeafAuto_Win7** 是一款专为 Windows 7（支持32位和64位）设计的桌面应用程序，基于 PyQt5 框架构建。该应用旨在提供强大的自动化任务处理和智能助手功能，涵盖多种实用模块，如信息自动化处理、活动管理等。

---

## 目录结构

---

## 技术栈

### 核心技术

- **Python**: 版本 3.11  
  - 作为主要编程语言，用于开发整个应用程序。
  
- **PyQt5**: 版本 6.4.2  
  - 用于创建图形用户界面的强大框架。
  
- **PyInstaller**: 版本 5.6.2  
  - 打包工具，用于生成可执行文件。
  
- **requests**: 版本 2.32.3  
  - HTTP 请求库，用于与外部 API 进行通信。
  
- **pywin32**: 版本 308  
  - 提供 Windows 平台上的扩展功能，包括互斥锁管理和系统信息获取。
  
- **QSharedMemory**: Qt 提供的进程间共享内存类  
  - 确保应用程序只有一个实例在运行。

---

## 功能模块概览

### 1. **App.py**
- **描述**: 主程序入口文件。
- **主要功能**:
  - 初始化 `QApplication`。
  - 使用 `QSharedMemory` 确保单一实例运行。
  - 创建并显示主窗口。
  - 启动主事件循环。

### 2. **MainWindow.py**
- **描述**: 主窗口的 UI 文件，由 `Ui_MainWindow.py` 生成。
- **主要功能**:
  - 显示主界面。
  - 处理用户交互。

### 3. **ActivitiesWindow.py**
- **描述**: 活动窗口的 UI 文件，由 `Ui_Activities.py` 生成。
- **主要功能**:
  - 显示活动列表。
  - 处理活动相关的用户交互。

### 4. **AiAssistant.py**
- **描述**: AI 助手模块，提供智能对话功能。
- **主要功能**:
  - 调用外部 AI API 进行对话。
  - 处理并展示 AI 返回的结果。

### 5. **Autolnfo.py**
- **描述**: 自动化信息处理模块。
- **主要功能**:
  - 解析和处理信息。
  - 执行自动化任务。

### 6. **common.py**
- **描述**: 公共工具函数模块。
- **主要功能**:
  - 日志记录。
  - 提供辅助函数。

### 7. **Thread.py**
- **描述**: 线程管理模块。
- **主要功能**:
  - 创建和管理多线程。
  - 处理异步任务。

### 8. **SystemInfo.py**
- **描述**: 系统信息模块。
- **主要功能**:
  - 获取系统信息。
  - 展示系统状态。

### 9. **update.py**
- **描述**: 更新模块。
- **主要功能**:
  - 检查更新。
  - 下载并安装更新。

### 10. **QT_Ui/Activities.ui 和 MainWindow.ui**
- **描述**: Qt Designer 设计的 UI 文件。
- **主要功能**:
  - 定义 UI 布局。
  - 通过 `pyuic6` 工具将 `.ui` 文件转换为 Python 代码。

### 11. **split.py**
- **描述**: 分割处理模块。
- **主要功能**:
  - 分割大文件。
  - 处理分割后的文件。

### 12. **LeafProcess.py**
- **描述**: 进程管理模块。
- **主要功能**:
  - 管理后台进程。
  - 处理进程间的通信。

---

## 关键特性

### 单一实例控制
采用 `QSharedMemory` 类确保系统中只有一个应用程序实例在运行，避免资源冲突。

### 用户界面设计
使用 Qt Designer 设计 UI，并通过 `pyuic6` 工具将 `.ui` 文件转换为 Python 代码，实现灵活的界面布局。

### 多线程处理
利用 `QThread` 实现后台任务的异步处理，保持 UI 的响应速度，提升用户体验。

### AI 集成
集成外部 AI API，提供智能化的用户交互体验，增强应用的功能性和易用性。

---

## 运行原理

### 1. **单实例运行**
- **原理**: 使用 `QSharedMemory` 类来确保应用程序只有一个实例在运行。
- **实现**:
  - 在 `App.py` 中创建一个 `QSharedMemory` 对象。
  - 尝试附加到已存在的共享内存，如果成功则显示警告消息并退出。
  - 尝试创建共享内存，如果失败则显示错误消息并退出。

### 2. **UI 设计**
- **原理**: 使用 Qt Designer 设计 UI，然后通过 `pyuic6` 工具将 `.ui` 文件转换为 Python 代码。
- **实现**:
  - 设计 `MainWindow.ui` 和 `Activities.ui` 文件。
  - 使用 `pyuic6` 将 `.ui` 文件转换为 `Ui_MainWindow.py` 和 `Ui_Activities.py`。

### 3. **多线程处理**
- **原理**: 使用 `QThread` 类来创建和管理多线程，确保 UI 界面的响应性。
- **实现**:
  - 在 `Thread.py` 中定义多个线程类。
  - 在主窗口中启动和管理这些线程。

### 4. **AI 助手**
- **原理**: 使用外部 AI API 进行对话处理。
- **实现**:
  - 在 `AiAssistant.py` 中调用 AI API。
  - 处理 AI 返回的结果并显示在界面上。

---

## 依赖库列表

以下列出了项目所需的所有依赖库及其版本号：

- **PyQt5**: 6.4.2
- **requests**: 2.32.3
- **pywin32**: 308
- **beautifulsoup4**: 4.12.3
- **certifi**: 2024.8.30
- **charset-normalizer**: 3.4.0
- **click**: 8.1.7
- **colorama**: 0.4.6
- **comtypes**: 1.4.8
- **idna**: 3.10
- **packaging**: 24.1
- **pefile**: 2024.8.26
- **pillow**: 11.0.0
- **psutil**: 6.1.0
- **pyinstaller**: 5.6.2
- **pyperclip**: 1.9.0
- **python-dotenv**: 1.0.1
- **pywin32-ctypes**: 0.2.3
- **qt6-applications**: 6.4.3.2.3
- **qt6-tools**: 6.4.3.1.3
- **setuptools**: 75.3.0
- **soupsieve**: 2.6
- **typing_extensions**: 4.12.2
- **urllib3**: 2.2.3
- **wheel**: 0.44.0
- **wxauto**: 3.9.11.17.5

---

## 安装与配置

### 安装依赖库

首先，确保您已经安装了 Python 3.11 或更高版本。然后，使用以下命令安装项目的依赖库：

```bash
  pyinstaller Application.spec
